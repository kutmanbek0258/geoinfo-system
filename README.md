# ГеоИнфоСистема

**ГеоИнфоСистема** — это комплексная веб-система для визуализации, управления и анализа геопространственных данных. Она построена на основе микросервисной архитектуры и предоставляет интерактивную карту для работы с объектами, документами и растровыми слоями (например, аэрофотоснимками с дронов).

## Ключевые возможности

- **Интерактивная карта:** Отображение и управление векторными объектами (точками, линиями, полигонами) на карте OpenLayers.
- **Управление данными:** Создание, редактирование и удаление гео-объектов с привязкой детальных характеристик.
- **Работа с документами:** Загрузка файлов (PDF, DOCX, изображения) в S3-совместимое хранилище (MinIO) и их привязка к объектам на карте.
- **Онлайн-редактирование:** Интеграция с **OnlyOffice** для редактирования документов (DOCX, XLSX, PPTX) прямо в браузере.
- **Растровые слои:** Отображение геопривязанных изображений (GeoTIFF) в виде слоев WMS/WMTS через **GeoServer**.
- **Полнотекстовый и гео-поиск:** Мощный поиск по атрибутам объектов и содержимому документов на базе **Elasticsearch**.
- **Ролевая модель доступа (RBAC):** Разграничение прав пользователей (Администратор, Редактор, Просмотрщик).

## Архитектура

Система использует **микросервисную архитектуру**, где каждый сервис отвечает за свою бизнес-логику и имеет собственную базу данных.

```
[ Клиент (Vue.js) ]
       |
[ nginx-proxy (Обратный прокси, балансировщик, кэш) ]
       |
[ API Gateway (Spring Cloud) ]
       |
       +-----------------------+-------------------------+
       |                       |                         |
[ Auth Service ]      [ Geodata Service ]      [ Document Service ] ... и другие
       |                       |                         |
[ PostgreSQL ]        [ PostGIS ]              [ PostgreSQL / MinIO ]

       | <------ [ Kafka (Асинхронные события) ] ------> |
       |                                                 |
[ Search Service (Elasticsearch) ]
```

- **Frontend:** Одностраничное приложение (SPA) на Vue.js, которое взаимодействует с бэкендом через API Gateway.
- **Backend:** Набор микросервисов на Java и Spring Boot.
- **API Gateway:** Единая точка входа, обеспечивающая маршрутизацию, аутентификацию и безопасность.
- **Асинхронное взаимодействие:** Apache Kafka используется для обмена событиями между сервисами (например, для индексации данных в Elasticsearch).

## Технологический стек

- **Frontend:** Vue.js 3, Vite, TypeScript, Vuetify 3, OpenLayers, Vuex
- **Backend:** Java 17, Spring Boot 3, Spring Cloud
- **Базы данных:** PostgreSQL, PostGIS, Elasticsearch, Redis
- **Хранилище файлов:** MinIO
- **Инфраструктура:** Docker, Docker Compose, Nginx, nginx-proxy, Kafka, GeoServer, OnlyOffice

## Быстрый старт (режим разработки)

Самый простой способ запустить весь проект локально — использовать Docker Compose. Этот режим автоматически соберет и запустит все сервисы, а также пробросит их порты на `localhost` для удобства разработки.

**Требования:**
- Docker
- Docker Compose

**Запуск:**
1. Убедитесь, что Docker запущен.
2. Выполните в корневой директории проекта:

   ```shell
   docker compose --env-file .env.example --env-file .env.secrets.example -f docker-compose.yml -f docker-compose.prod.yml up --build
   ```
   - `--build`: Эта опция пересобирает образы, если в исходном коде были изменения. Используйте ее при первом запуске или после внесения правок.

3. После запуска всех контейнеров приложение будет доступно по адресу: **http://127.0.0.1**.

**Остановка:**
- Для остановки всех сервисов нажмите `Ctrl+C` в терминале, где была запущена команда.
- Либо, из другой консоли, выполните:
  ```shell
  docker-compose -f docker-compose.yml -f docker-compose.prod.yml down
  ```

## Структура репозитория

- **[<code>api-gateway/</code>](./api-gateway/README.md):** Шлюз API (Spring Cloud Gateway).
- **[<code>auth-service/</code>](./auth-service/README.md):** Сервис аутентификации.
- **`common-lib/`:** Общая библиотека с утилитами для всех сервисов.
- **[<code>config-server/</code>](./config-server/README.md):** Сервер конфигураций.
- **[<code>discovery-server/</code>](./discovery-server/README.md):** Сервер обнаружения (Eureka).
- **[<code>document-service/</code>](./document-service/README.md):** Сервис управления документами.
- **[<code>frontend/</code>](./frontend/README.md):** Клиентское приложение на Vue.js.
- **[<code>geodata-service/</code>](./geodata-service/README.md):** Сервис управления геоданными.
- **[<code>search-service/</code>](./search-service/README.md):** Сервис поиска.
- **[<code>nginx-proxy/</code>](./nginx-proxy/README.md):** Обратный прокси, балансировщик нагрузки и кэширующий слой.
- **`docs/`:** Техническая и архитектурная документация.

## Дополнительная документация

- **[Документация по Docker](./README_DOCKER.md):** Подробное описание докеризации, сред и команд.
- **[Документация по Frontend](./frontend/README.md):** Детальное описание фронтенд-приложения, его структуры и переменных окружения.