# This file is an example of the environment variables that can be set for the application.
# Copy this file to .env and fill in the values for your environment.
#
# To use this file with docker-compose, you can either:
# 1. Rename this file to .env and docker-compose will automatically pick it up.
# 2. Specify it explicitly during the docker-compose up command:
#    docker-compose --env-file .env.example --env-file .env.secrets.example up
#
# Note: This file contains non-sensitive variables. Sensitive variables are in .env.secrets.example.

#================================================================================
# Глобальные настройки сети и портов (Global Network & Port Settings)
#================================================================================
# IP-адрес хоста, используется для построения URL-адресов по умолчанию
HOST=localhost

# Порт, на котором будет доступно фронтенд-приложение
FRONTEND_PORT=8080
# Порт для API Gateway
API_GATEWAY_PORT=9005
# Порт для сервиса аутентификации (auth-service)
AUTH_SERVICE_PORT=9001
# Порт для OnlyOffice Document Server
ONLYOFFICE_PORT=8081
# Порт для GeoServer
GEOSERVER_PORT=8085
# Порт для API MediaMTX (по умолчанию 9997)
MEDIAMTX_API_PORT=9997
# Порт для HLS-трансляций MediaMTX (доступен извне)
MEDIAMTX_HLS_PORT=8888
# Порт для проки сервера
PROXY_PORT=80

#================================================================================
# Настройки CORS (Cross-Origin Resource Sharing)
#================================================================================
# Разрешенные источники для CORS (через запятую). Должен включать домен вашего фронтенда.
CORS_ALLOWED_ORIGINS=http://${HOST}:${PROXY_PORT},http://${HOST}

#================================================================================
# Домен сервиса аутентификации (AUTH_SERVICE_DOMAIN)
# Используется для построения URL-адресов для редиректов OAuth2 и Issuer URL.
# Должен быть доступен из внешнего мира, если приложение развернуто публично.
#================================================================================
AUTH_SERVICE_SUBDOMAIN=sso
AUTH_SERVICE_DOMAIN=http://${AUTH_SERVICE_SUBDOMAIN}.localhost

#================================================================================
# Домен MediaMTX для HLS-трансляций (MEDIAMTX_HLS_DOMAIN)
# Используется для построения URL-адресов HLS-трансляций.
#================================================================================
MEDIAMTX_HLS_DOMAIN=http://${HOST}

#================================================================================
# Переменные конфигурации фронтенда (Vite)
# Используются для сборки фронтенд-приложения.
#================================================================================
VITE_API_URL=/
VITE_API_GATEWAY_URL=http://${HOST}/api
VITE_AUTH_SERVICE_URL=http://${AUTH_SERVICE_SUBDOMAIN}.${HOST}
VITE_AUTH_CALLBACK_URL=http://${HOST}/code
VITE_ONLYOFFICE_URL=http://${HOST}/onlyoffice
VITE_GEOSERVER_URL=http://${HOST}/geoserver/wms
VITE_ONLYOFFICE_API_URL=http://${HOST}/api/documents

#================================================================================
# Настройки Kafka (Message Broker)
#================================================================================
KAFKA_BOOTSTRAP_SERVERS=kafka:9092

#================================================================================
# Настройки Elasticsearch (Search Engine)
#================================================================================
ELASTICSEARCH_URI=elasticsearch:9200

#================================================================================
# Настройки Redis (для auth-service)
#================================================================================
REDIS_DB=0
REDIS_HOST=redis-auth
REDIS_PORT=6379

#================================================================================
# Имена баз данных PostgreSQL
#================================================================================
POSTGRES_DB_AUTH=auth_db
POSTGRES_HOST_AUTH=postgres-auth
POSTGRES_PORT_AUTH=5432

POSTGRES_DB_GEODATA=geodata_db
POSTGRES_HOST_GEODATA=postgres-geodata
POSTGRES_PORT_GEODATA=5432

POSTGRES_DB_DOCS=docs_db
POSTGRES_HOST_DOCS=postgres-docs
POSTGRES_PORT_DOCS=5432

#================================================================================
# Другие переменные приложения
#================================================================================
# URL для интроспекции токенов (используется микросервисами)
SSO_URL=http://auth-service:${AUTH_SERVICE_PORT}
# Базовый путь для хранения файлов auth-service
AUTH_SERVICE_PATH_STORAGE=~/auth-service-file-store
# Включение ANSI-кодов в выводе консоли Spring Boot
JSSO_ANSI_ENABLED=ALWAYS

#================================================================================
# Настройки MediaMTX (стриминг)
#================================================================================
# Включает/выключает запуск потоков по требованию
MEDIAMTX_SOURCEONDEMAND=true
# Время (в секундах), через которое поток останавливается при отсутствии клиентов
MEDIAMTX_SOURCEONDEMANDCLOSEAFTER=20s
# Частота очистки (в миллисекундах) неактивных потоков
MEDIAMTX_CLEANUP_RATE=300000